{% extends "base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'game/match.css' %}">

<section class="match-page">
  <div class="match-board">

    <!-- ì¹´ë“œ 10ìž¥ (ìž¥ì‹ìš© / í´ë¦­ ì—†ìŒ) -->
    <div class="card-row">
      <img class="card" src="{% static 'cards/card1.jpg' %}" alt="">
      <img class="card" src="{% static 'cards/card2.jpg' %}" alt="">
      <img class="card" src="{% static 'cards/card3.jpg' %}" alt="">
      <img class="card" src="{% static 'cards/card4.jpg' %}" alt="">
      <img class="card" src="{% static 'cards/card5.jpg' %}" alt="">
      <img class="card" src="{% static 'cards/card6.jpg' %}" alt="">
      <img class="card" src="{% static 'cards/card7.jpg' %}" alt="">
      <img class="card" src="{% static 'cards/card8.jpg' %}" alt="">
      <img class="card" src="{% static 'cards/card9.jpg' %}" alt="">
      <img class="card" src="{% static 'cards/card10.jpg' %}" alt="">
    </div>

    <div class="match-center">
      {% if mode == "NEW" %}
        <!-- ðŸ”¥ ATTACK í™”ë©´ -->
        <form class="match-form" method="post" action="{% url 'game:new' %}">
          {% csrf_token %}

          <div class="row">
            <div class="label">DEFENDER</div>
            <div class="select-wrap">
              <select id="defenderSelect" name="defender_id" class="select" required>
                <option value="" selected disabled></option>
                {% for u in candidates %}
                  <option value="{{ u.id }}">{{ u.username|upper }}</option>
                {% endfor %}
              </select>
              <span class="select-arrow">â–¼</span>
            </div>
          </div>

          <!-- defender ì„ íƒ ì „ì—” ë¹„í™œì„±, ì„ íƒí•˜ë©´ í™œì„± -->
          <button id="drawBtn" class="draw-btn" type="submit" disabled>
            ì¹´ë“œ ë½‘ê¸°
          </button>
        </form>

      {% elif mode == "COUNTER" %}
        <!-- ðŸ”¥ COUNTER í™”ë©´ -->
        <form class="match-form" method="post" action="{% url 'game:play' match.id %}">
          {% csrf_token %}

          <div class="row">
            <div class="label">ATTACKER</div>
            <div class="pill">
              {{ match.attacker.username|upper }}
            </div>
          </div>

          <button class="draw-btn" type="submit">
            ì¹´ë“œ ë½‘ê¸°
          </button>
        </form>
      {% endif %}
    </div>
  </div>
</section>

<!-- âœ… NEW í™”ë©´: defender ì„ íƒë§Œìœ¼ë¡œ ë²„íŠ¼ í™œì„±í™” -->
<script>
  (function () {
    const defenderSelect = document.getElementById("defenderSelect");
    const drawBtn = document.getElementById("drawBtn");

    if (!defenderSelect || !drawBtn) return;

    const sync = () => {
      drawBtn.disabled = !defenderSelect.value;
    };

    defenderSelect.addEventListener("change", sync);
    sync();
  })();
</script>
{% endblock %}
