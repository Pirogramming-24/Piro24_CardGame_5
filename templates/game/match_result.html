{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'game/playing.css' %}"> 
    <style>
        .result-container {
            max-width: 600px;
            margin: 50px auto;
            text-align: center;
            color: #fff;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5); /* ì˜ ë³´ì´ê²Œ ë°°ê²½ ì¶”ê°€ */
            border-radius: 15px;
        }
        .vs-title { font-size: 2rem; margin-bottom: 20px; font-weight: bold; }
        .status-badge {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 20px;
            background: #6f42c1;
            margin-bottom: 30px;
            font-weight: bold;
        }
        .card-box {
            font-size: 5rem;
            font-weight: bold;
            color: #ffd700;
            margin: 20px 0;
            text-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }
        .score-info { font-size: 1.2rem; color: #ddd; margin-bottom: 30px; }
        .btn-group { display: flex; gap: 10px; justify-content: center; }
    </style>
{% endblock %}

{% block content %}
<div class="result-container">
    
    <div class="vs-title">
        {{ match.attacker.username }} <span style="font-size: 1rem; color:#aaa;">vs</span> {{ match.defender.username }}
    </div>

    <div class="status-badge">
        {% if match.status == "PENDING" %}
            â³ ì§„í–‰ ì¤‘ (Waiting)
        {% elif match.status == "FINISHED" %}
            ğŸ ê²Œì„ ì¢…ë£Œ (Finished)
        {% else %}
            âŒ ì·¨ì†Œë¨
        {% endif %}
    </div>

    {% if match.status == "PENDING" %}
        
        {% if user == match.attacker %}
            <div class="info-text">
                <h3>ìƒëŒ€ë°©ì˜ ìˆ˜ë½ì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤.</h3>
                <p>ë‚´ê°€ ë‚¸ ì¹´ë“œ: <strong>{{ match.attacker_card }}</strong></p>
                <p>ë£°: {% if match.rule == "HIGH_WINS" %}ë†’ì€ ìˆ«ì ìŠ¹ë¦¬{% else %}ë‚®ì€ ìˆ«ì ìŠ¹ë¦¬{% endif %}</p>
            </div>
            
            <form action="{% url 'game:cancel' match.id %}" method="POST" style="margin-top: 20px;">
                {% csrf_token %}
                <button type="submit" class="btn" style="background: #dc3545;">ê²Œì„ ì·¨ì†Œí•˜ê¸°</button>
            </form>

        {% elif user == match.defender %}
            <div class="info-text">
                <h3>ë„ì „ì¥ì´ ë„ì°©í–ˆìŠµë‹ˆë‹¤!</h3>
                <p>ìƒëŒ€ë°©ì´ ê³µê²©í–ˆìŠµë‹ˆë‹¤. ë°˜ê²©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
            </div>
            
            <a href="{% url 'game:counter' match.id %}" class="btn" style="background: #28a745; text-decoration: none; display: inline-block; margin-top: 20px;">
                ğŸ›¡ï¸ ë°˜ê²©í•˜ëŸ¬ ê°€ê¸°
            </a>
        {% endif %}

    {% elif match.status == "FINISHED" %}
        
        <div class="result-box">
            <h2>
                {% if match.result == "DRAW" %}
                    ğŸ¤ ë¬´ìŠ¹ë¶€!
                {% elif match.result == "ATTACKER_WIN" %}
                    ğŸ† {{ match.attacker.username }} ìŠ¹ë¦¬!
                {% else %}
                    ğŸ† {{ match.defender.username }} ìŠ¹ë¦¬!
                {% endif %}
            </h2>

            <div style="display: flex; justify-content: center; gap: 50px; margin: 30px 0;">
                <div>
                    <p>{{ match.attacker.username }}</p>
                    <div class="card-box">{{ match.attacker_card }}</div>
                    <p>{% if match.result == "ATTACKER_WIN" %}+{{ match.attacker_delta }}{% else %}{{ match.attacker_delta }}{% endif %}</p>
                </div>
                <div style="align-self: center; font-size: 2rem;">VS</div>
                <div>
                    <p>{{ match.defender.username }}</p>
                    <div class="card-box">{{ match.defender_card }}</div>
                    <p>{% if match.result == "DEFENDER_WIN" %}+{{ match.defender_delta }}{% else %}{{ match.defender_delta }}{% endif %}</p>
                </div>
            </div>

            <a href="{% url 'game:list' %}" class="btn">ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>

    {% endif %}

</div>
{% endblock %}